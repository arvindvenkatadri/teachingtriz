{
  "hash": "6718a6d308133fe872fa95ea89eed818",
  "result": {
    "markdown": "---\ntitle: 'Inference for numerical data'\nauthor: \"Arvind Venkatadri\"\ndate: 22/Nov/2022\ndate-modified: \"2023-12-31\"\n---\n\n\n## Getting Started\n\n### Load packages\n\nIn this lab, we will explore and visualize the data using the\n**tidyverse** suite of packages, and perform statistical inference using\n**infer**. The data can be found in the companion package for OpenIntro\nresources, **openintro**.\n\nLet's load the packages.\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/setup_23cc7aed4789eeb894dfd35b198fca8d'}\n\n```{.r .cell-code}\nlibrary(mosaic)\nlibrary(tidyverse)\nlibrary(openintro)\nlibrary(infer)\nlibrary(skimr)\n```\n:::\n\n\n### Creating a reproducible lab report\n\nTo create your new lab report, in RStudio, go to New File -\\> R\nMarkdown... Then, choose From Template and then choose\n`Lab Report for OpenIntro Statistics Labs` from the list of templates.\n\n### The data\n\nEvery two years, the Centers for Disease Control and Prevention conduct\nthe **Youth Risk Behavior Surveillance System (YRBSS)** survey, where it\ntakes data from high schoolers (9th through 12th grade), to analyze\nhealth patterns. You will work with a selected group of variables from a\nrandom sample of observations during one of the years the YRBSS was\nconducted.\n\nLoad the `yrbss` data set into your workspace.\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/load-data_bf2a4c40877b2259180fdbf7a77ebc6c'}\n\n```{.r .cell-code}\ndata(yrbss)\n```\n:::\n\n\n## Exploratory data analysis\n\nThere are observations on 13 different variables, some categorical and\nsome numerical. The meaning of each variable can be found by bringing up\nthe help file: type this in your console\n\n::: callout-note\nhelp(yrbss)\n:::\n\n::: callout-note\n1 . What are the cases in this data set? How many cases are there in our\nsample?\n:::\n\nYou will first start with analyzing the weight of the participants in\nkilograms: `weight`.\n\nUsing visualization and summary statistics, describe the distribution of\nweights. The `inspect()` function from the **mosaic** package produces\nnice summaries of the variables in the dataset, separating categorical\n(character) variables from quantitative variables.\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/inspect_573560ed28f0ca060b37d2f529dafee3'}\n\n```{.r .cell-code}\nmosaic::inspect(yrbss)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\ncategorical variables:  \n                      name     class levels     n missing\n1                   gender character      2 13571      12\n2                    grade character      5 13504      79\n3                 hispanic character      2 13352     231\n4                     race character      5 10778    2805\n5               helmet_12m character      6 13272     311\n6   text_while_driving_30d character      8 12665     918\n7  hours_tv_per_school_day character      7 13245     338\n8 school_night_hours_sleep character      7 12335    1248\n                                   distribution\n1 male (51.2%), female (48.8%)                 \n2 9 (26.6%), 12 (26.3%), 11 (23.6%) ...        \n3 not (74.4%), hispanic (25.6%)                \n4 White (59.5%) ...                            \n5 never (52.6%), did not ride (34.3%) ...      \n6 0 (37.8%), did not drive (36.7%) ...         \n7 2 (20.4%), <1 (16.4%), 3 (16.1%) ...         \n8 7 (28.1%), 8 (21.8%), 6 (21.5%) ...          \n\nquantitative variables:  \n                  name   class   min    Q1 median    Q3    max      mean\n1                  age integer 12.00 15.00  16.00 17.00  18.00 16.157041\n2               height numeric  1.27  1.60   1.68  1.78   2.11  1.691241\n3               weight numeric 29.94 56.25  64.41 76.20 180.99 67.906503\n4 physically_active_7d integer  0.00  2.00   4.00  7.00   7.00  3.903005\n5 strength_training_7d integer  0.00  0.00   3.00  5.00   7.00  2.949948\n          sd     n missing\n1  1.2637373 13506      77\n2  0.1046973 12579    1004\n3 16.8982128 12579    1004\n4  2.5641046 13310     273\n5  2.5768522 12407    1176\n```\n:::\n:::\n\n\nNext, consider the possible relationship between a high schooler's\nweight and their physical activity. Plotting the data is a useful first\nstep because it helps us quickly visualize trends, identify strong\nassociations, and develop research questions.\n\nFirst, let's create a new variable `physical_3plus`, which will be coded\nas either \"yes\" if the student is physically active for *at least* 3\ndays a week, and \"no\" if not. Recall that we have several *missing* data\nin that column, so we will (sadly) drop these before generating the new\nvariable:\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/create new var_d129077d59cc188b97bac696b7ea6117'}\n\n```{.r .cell-code}\nyrbss <- yrbss %>% \n  drop_na() %>% \n  mutate(physical_3plus = if_else(physically_active_7d >= 2, \"yes\", \"no\"),\n         physical_3plus = factor(physical_3plus, \n                                 labels = c(\"yes\", \"no\"),\n                                 levels = c(\"yes\", \"no\")))\n# Let us check\nyrbss %>% count(physical_3plus)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"physical_3plus\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[2],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"yes\",\"2\":\"6466\"},{\"1\":\"no\",\"2\":\"1885\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n::: callout-note\n2.  Make a side-by-side violin box plots of `physical_3plus` and\n    `weight`.\n3.  Is there a relationship between these two variables? What did you\n    expect and why?\n:::\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/unnamed-chunk-2_dd065b5c527df378626b310168746baf'}\n\n```{.r .cell-code}\ngf_boxplot(weight ~ physical_3plus, \n          fill = ~ physical_3plus,\n          data = yrbss,\n          draw_quantiles = TRUE)\n```\n\n::: {.cell-output-display}\n![](inf_for_numerical_data_files/figure-html/unnamed-chunk-2-1.png){width=2100}\n:::\n:::\n\n\nThe box plots show how the medians of the two distributions compare, but\nwe can also compare the means of the distributions using the following\nto first group the data by the `physical_3plus` variable, and then\ncalculate the mean `weight` in these groups using the `mean` function\nwhile ignoring missing values by setting the `na.rm` argument to `TRUE`.\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/by-means_0b23971156f79003ae40886b421f47d7'}\n\n```{.r .cell-code}\nyrbss %>%\n  group_by(physical_3plus) %>%\n  summarise(mean_weight = mean(weight, na.rm = TRUE))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"physical_3plus\"],\"name\":[1],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"mean_weight\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"yes\",\"2\":\"68.57404\"},{\"1\":\"no\",\"2\":\"66.87966\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nThere is an observed difference, but is this difference large enough to\ndeem it \"statistically significant\"? In order to answer this question we\nwill conduct a hypothesis test.\n\n## Inference\n\n::: callout-important\nAre all conditions necessary for inference satisfied? Comment on each.\nYou can compute the group sizes with the `summarize` command above by\ndefining a new variable with the definition `n()`.\n:::\n\n::: callout-note\nWrite the hypotheses for testing if the average weights are different\nfor those who exercise at least times a week and those who don't.\n\nWrite here !\n:::\n\nWe will do this in two ways, just for fun: one using `mosaic` and the\nother using `infer`.\n\nBut first, we need to initialize the test, which we will save as\n`obs_diff`.\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/inf-weight-habit-ht-initial_1938817461b14e0e5be432bd64267b6b'}\n\n```{.r .cell-code}\nobs_diff_infer <- yrbss %>%\n  specify(weight ~ physical_3plus) %>%\n  calculate(stat = \"diff in means\", order = c(\"yes\", \"no\"))\nobs_diff_infer\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"stat\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1.694383\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n\n```{.r .cell-code}\nobs_diff_mosaic <- diffmean(~ weight | physical_3plus, data = yrbss)\nobs_diff_mosaic\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n diffmean \n-1.694383 \n```\n:::\n:::\n\n\n::: callout-important\nNote that `obs_diff_infer` is a 1 X 1 dataframe; `obs_diff_mosaic` is a\nscalar!!\n:::\n\n::: {.panel-tabset style=\"fill:burlywood\"}\n## Inference Using \\`infer\\`\n\nNext, we will work through creating a permutation distribution using\ntools from the **infer** package.\n\nRecall that the `specify()` function is used to specify the variables\nyou are considering (notated `y ~x`), and you can use the `calculate()`\nfunction to specify the `stat`istic you want to calculate and the\n`order` of subtraction you want to use. For this hypothesis, the\nstatistic you are searching for is the difference in means, with the\norder being `yes - no`.\n\nAfter you have calculated your observed statistic, you need to create a\npermutation distribution. This is the distribution that is created by\nshuffling the observed weights into new `physical_3plus` groups, labeled\n\"yes\" and \"no\".\n\nWe will save the permutation distribution as `null_dist`.\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/inf-weight-habit-ht-null_0773b3a4647d8c06d85d3857f1fc767a'}\n\n```{.r .cell-code}\nnull_dist <- yrbss %>%\n  specify(weight ~ physical_3plus) %>%\n  hypothesize(null = \"independence\") %>%\n  generate(reps = 1000, type = \"permute\") %>%\n  calculate(stat = \"diff in means\", order = c(\"yes\", \"no\"))\n```\n:::\n\n\nThe `hypothesize()` function is used to declare what the null hypothesis\nis. Here, we are assuming that student's weight is independent of\nwhether they exercise at least 3 days or not.\n\nWe should also note that the `type` argument within `generate()` is set\nto `\"permute\"`. This ensures that the statistics calculated by the\n`calculate()` function come from a reshuffling of the data (not a\nresampling of the data)! Finally, the `specify()` and `calculate()`\nsteps should look familiar, since they are the same as what we used to\nfind the observed difference in means!\n\nWe can visualize this null distribution with the following code:\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/unnamed-chunk-3_53b2b896b09595f18e10c448f6cfcc96'}\n\n```{.r .cell-code}\ngf_histogram(data = null_dist, ~ stat)\n```\n\n::: {.cell-output-display}\n![](inf_for_numerical_data_files/figure-html/unnamed-chunk-3-1.png){width=2100}\n:::\n:::\n\n\n::: callout-note\n5.  Add a vertical red line to the plot above, demonstrating where the\n    observed difference in means (`obs_diff_mosaic`) falls on the\n    distribution.\n\n6.  How many of these `null_dist` permutations have a difference at\n    least as large (or larger) as `obs_diff_mosaic`?\n:::\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/unnamed-chunk-4_fe27c6e15c2f02f9b92125b069f52eae'}\n\n:::\n\n\nNow that you have calculated the observed statistic and generated a\npermutation distribution, you can calculate the p-value for your\nhypothesis test using the function `get_p_value()` from the infer\npackage.\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/inf-weight-habit-ht-pvalue_fb47e99b79706a7d9fa43d1c6f715d15'}\n\n```{.r .cell-code}\nnull_dist %>%\n  get_p_value(obs_stat = obs_diff_infer, direction = \"two_sided\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"p_value\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n7.  \n\n-   What warning message do you get? Why do you think you get this\n    warning message?\n-   Construct and record a confidence interval for the difference\n    between the weights of those who exercise at least three times a\n    week and those who don't, and interpret this interval in context of\n    the data.\n\n------------------------------------------------------------------------\n\n## Inference Using \\`mosaic\\`\n\nWe already have the observed difference, `obs_diff_mosaic`. Now we\ngenerate the null distribution using permutation, with `mosaic`:\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/unnamed-chunk-5_adbfd55834fe0afd5be501d2fe0e5185'}\n\n```{.r .cell-code}\nnull_dist_mosaic <- do(1000) * diffmean(~ weight | shuffle(physical_3plus), data = yrbss)\n```\n:::\n\n\nWe can also generate the histogram of the null distribution, compare\nthat with the `obs`erved `diff`rence and compute the `p-value` and\n`confidence intervals`:\n\n\n::: {.cell hash='inf_for_numerical_data_cache/html/unnamed-chunk-6_997f4188e626e186f934b07a9337637c'}\n\n```{.r .cell-code}\ngf_histogram(~ diffmean, data = null_dist_mosaic) %>% \n  gf_vline(xintercept = obs_diff_mosaic, colour = \"red\")\n```\n\n::: {.cell-output-display}\n![](inf_for_numerical_data_files/figure-html/unnamed-chunk-6-1.png){width=2100}\n:::\n\n```{.r .cell-code}\n# p-value\nprop(~ diffmean >= obs_diff_mosaic, data = null_dist_mosaic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nprop_TRUE \n        1 \n```\n:::\n\n```{.r .cell-code}\n# Confidence Intervals for p = 0.95\nmosaic::cdata(~ diffmean, p = 0.95, data = null_dist_mosaic)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"lower\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"upper\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"central.p\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"-0.8399787\",\"2\":\"0.8733848\",\"3\":\"0.95\",\"_rn_\":\"2.5%\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n------------------------------------------------------------------------\n:::\n\n## More Practice\n\n9.  Calculate a 95% confidence interval for the average height in meters\n    (`height`) and interpret it in context.\n\n10. Calculate a new confidence interval for the same parameter at the\n    90% confidence level. Comment on the width of this interval versus\n    the one obtained in the previous exercise.\n\n11. Conduct a hypothesis test evaluating whether the average height is\n    different for those who exercise at least three times a week and\n    those who don't.\n\n12. Now, a non-inference task: Determine the number of different options\n    there are in the dataset for the `hours_tv_per_school_day` there\n    are.\n\n13. Come up with a research question evaluating the relationship between\n    height or weight and sleep. Formulate the question in a way that it\n    can be answered using a hypothesis test and/or a confidence\n    interval. Report the statistical results, and also provide an\n    explanation in plain language. Be sure to check all assumptions,\n    state your $\\alpha$ level, and conclude in context.\n\n------------------------------------------------------------------------\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../../../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../../../../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}